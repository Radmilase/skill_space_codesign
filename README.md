# Skill-Oriented Co-Design for Robust Dexterous Grasping

## О проекте

Проект посвящён совместному проектированию морфологии захвата и управления с фокусом на пространство манипуляционных навыков. В отличие от традиционных co-design подходов, где конструкция оптимизируется под конкретный сценарий или ограниченный набор задач, в данной работе рассматривается способность одной и той же морфологии поддерживать различные устойчивые режимы взаимодействия с объектами.
В реальных условиях параметры манипуляции постоянно меняются: отличаются объекты, начальные конфигурации, характеристики контакта и внешние воздействия. Конструкция, оптимизированная под фиксированный сценарий, часто показывает плохой результат при изменениях сценариев. 
В результате исследования преполагается получить подход к оценке морфологии захвата понабору пространственных манипуляционных навыков.
## Постановка проблемы

В современных работах по co-design авторы обычно оптимизируют конструкцию под фиксированный сценарий, при смене условий или сценария, качество захвата ухудшается. Это делает co-design плохо масштабируемым для универсальной манипуляции.

В работе [Co-Design of Soft Gripper with Neural Physics](https://openreview.net/forum?id=EBcb4LemZZ&referrer=%5Bthe%20profile%20of%20Adabhav%20Singh%5D(%2Fprofile%3Fid%3D~Adabhav_Singh1)) авторы совместно оптимизируют распределение жесткости и позу захвата, используя нейросетевой суррогат физики, обученный в симуляции. Критерий оптимизации ориентирован на успешность захвата объектов в рамках одноого сценария.

В статье [Design and Control Co-Optimization for Automated Design Iteration of Dexterous Anthropomorphic Soft Robotic Hands](https://ieeexplore.ieee.org/document/10521927) авторы улучшили манипуляционные действия за счет co-design и управления, но оценка морфологии проводится по фиксированному набору задач/сценариев.

В работе [A Detachable Crawling Robotic Hand](https://www.nature.com/articles/s41467-025-67675-8) показано, что одна и та же морфология может поддерживать несколько различных способов взаимодействия с объектами, включая захват, удержание и перемещение. Однако универсальность конструкции демонстрируется на уровне отдельных экспериментальных сценариев. Отсутствует формализованный и количественный критерий, позволяющий оценивать и оптимизировать морфологию по пространству поддерживаемых навыков, а не по отдельным сценариям.


Проведя анализ можно заметить, что универсальность добивается за счёт управления при фиксированной морфологии. 
В работе [Dexterous Hand Co-Design for In-Hand Rotation](https://openreview.net/pdf/e99a1898b31c1369e85da2ee03f6cffe6b3954d4.pdf) совместное проектирование морфологии и управления проводится с явной ориентацией на один режим взаимодействия in-hand rotation. Это позволяет получить конструкцию, выполняющую выбранный навык, но морфология подходит только под конкретную форму взаимодействия. В результате способность конструкции поддерживать другие манипуляционные навыки и сохранять устойчивость при смене режима взаимодействия не рассматривается и не оценивается количественно.

Анализ современных работ по co-design показывает, что в большинстве случаев оптимизация морфологии и управления проводится относительно заранее заданных манипуляционных сценариев. Конструкция подбирается таким образом, чтобы демонстрировать высокое качество в конкретных условиях, однако при другом сценарии качество взаимодействия часто ухудшается.

Сценарий в данном проекте понимается как эксперимент с фиксированными начальными условиями: целевой объект, начальная поза, трение и возмущения, а также критерий успеха. 
Навык описывает устойчивый тип взаимодействия, который сохраняет свою структуру при изменении этих условий, он может реализовываться для различных объектов, при разных начальных позах и направлениях приложенной силы. То есть навык это множество сценариев.
А пространство навыков это набор навыков, которые морфология может выполнять успешно на диапазоне условий.

## Гипотеза

Если оптимизировать морфологию роботизированного захвата по пространству манипуляционных навыков, то полученная морфология будет демонстрировать более устойчивое и обобщаемое поведение при смене объектов, начальных конфигураций и параметров взаимодействия по сравнению с морфологиями, оптимизированными под фиксированные сценарии.

## Baseline

В качестве базовой работы выбран проект [Co-Design of Soft Gripper with Neural Physics](https://yswhynot.github.io/codesign-soft/), [GitHub](https://github.com/yswhynot/codesign-soft-gripper), [статья](https://arxiv.org/abs/2505.20404).

В данном проекте сформулирован воспроизводимый подход к co-design захвата. Морфология задается в виде вектора параметров. Каждый палец разбивается на блоки и каждому блоку сопоставляется скалярный параметр жесткости. Совокупность значений образует вектор параметров. Он определяет как именно деформируется захват при захвате объекта, влияент на распрелеление сил. Нейронная модель была обучена на симуляциях с параметрами захвата: геометрия, количество пальцев, кинематика и типы контактов, поэтому при изменении жесткости блоков она предсказывает результат взаимодействия с учетом этих характеристик.
Такой вектор параметров морфологии можно использовать в оптимизации оценки пространства навыков.
Симуляция мягкого захвата через Warp используется авторами для генерации данных: они прогоняют много вариантов жесткостей, поз и объектов и собирают результаты успеха захвата, стабильности, силы.
На этих данных обучается нейросетевая модель. На вход подаются значения вектора жесткостей, параметры управления, описание объекта. На выходе получается прогноз результата захвата. После обучения оптимизация co-design проводится уже на этой модели, а не на реальной физике. 
Оптимизация проводится под один тип поведения это статический захват. Универсальность достигается за счет оптимизации по разным объектам, но сценарий манипуляции остается тем же.


## Будущая работа

Морфология задается вектором параметров. Будет задаваться набор навыков и для каждого из них задается распределение условий выполнения навыка: объект, начальная позиция, величина внешних возмущений.
Для каждой морфологии выполняется серия прогонов в симуляции/прокси-модели, где сценарии сэмплируются из этих распределений. На каждом прогоне собираются численные метрики качества взаимодействия (успех/стабильность/проскальзывание/энергия или их аналоги). Дальше результаты агрегируются по навыкам и по всему набору навыков, чтобы получить устойчивую оценку: какие навыки морфология поддерживает надёжно и насколько чувствительна к смене условий.
Затем проводим сравнительный анализ по агрегированной оценке навыков. Этот критерий становится целевой функцией для co-design: планируется подбор параметров морфологии так, чтобы улучшать качество по набору навыков.
Для проверки тестовой гипотезы был написан небольшой скрипт quick_test_skillspace.py.

Скрипт использует нейронный прокси simulate_neural и задаёт морфологию как вектор параметров stiffness_blocks. на каждом испытании случайно выбирается навык из множества pinch/power/push и генерируются его параметры. Они сводятся к одному числу score. По серии экспериментов получаем статистику каждому навыку (среднее значение, разброс).

В режиме codesign реализуется random search, где генерируется много случайных векторов stiffness_blocks, для каждого считает средний score по набору навыков и выбирает лучший. Все результаты сохраняются в папку runs.
