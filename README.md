# Skill-Oriented Co-Design for Robust Dexterous Grasping

## О проекте

Проект посвящён совместному проектированию морфологии захвата и управления с фокусом на пространство манипуляционных навыков. В отличие от традиционных co-design подходов, где конструкция оптимизируется под конкретный сценарий или ограниченный набор задач, в данной работе рассматривается способность одной и той же морфологии поддерживать различные устойчивые режимы взаимодействия с объектами.
В реальных условиях параметры манипуляции постоянно меняются: отличаются объекты, начальные конфигурации, характеристики контакта и внешние воздействия. Конструкция, оптимизированная под фиксированный сценарий, часто показывает плохой результат при изменениях сценариев. 
В результате исследования преполагается получить подход к оценке морфологии захвата понабору пространственных манипуляционных навыков.
## Постановка проблемы

В современных работах по co-design авторы обычно оптимизируют конструкцию под фиксированный сценарий, при смене условий или сценария, качество захвата ухудшается. Это делает co-design плохо масштабируемым для универсальной манипуляции.

В работе [Co-Design of Soft Gripper with Neural Physics](https://openreview.net/forum?id=EBcb4LemZZ&referrer=%5Bthe%20profile%20of%20Adabhav%20Singh%5D(%2Fprofile%3Fid%3D~Adabhav_Singh1)) авторы совместно оптимизируют распределение жесткости и позу захвата, используя нейросетевой суррогат физики, обученный в симуляции. Критерий оптимизации ориентирован на успешность захвата объектов в рамках одноого сценария.

В статье [Design and Control Co-Optimization for Automated Design Iteration of Dexterous Anthropomorphic Soft Robotic Hands](https://ieeexplore.ieee.org/document/10521927) авторы улучшили манипуляционные действия за счет co-design и управления, но оценка морфологии проводится по фиксированному набору задач/сценариев.

В работе [A Detachable Crawling Robotic Hand](https://www.nature.com/articles/s41467-025-67675-8) показано, что одна и та же морфология может поддерживать несколько различных способов взаимодействия с объектами, включая захват, удержание и перемещение. Однако универсальность конструкции демонстрируется на уровне отдельных экспериментальных сценариев. Отсутствует формализованный и количественный критерий, позволяющий оценивать и оптимизировать морфологию по пространству поддерживаемых навыков, а не по отдельным сценариям.


Проведя анализ можно заметить, что универсальность добивается за счёт управления при фиксированной морфологии. 
В работе [Dexterous Hand Co-Design for In-Hand Rotation](https://openreview.net/pdf/e99a1898b31c1369e85da2ee03f6cffe6b3954d4.pdf) совместное проектирование морфологии и управления проводится с явной ориентацией на один доминирующий режим взаимодействия — in-hand rotation. Это позволяет получить конструкцию, выполняющую выбранный навык, однако морфология подходит только под конкретную форму взаимодействия. В результате способность конструкции поддерживать другие манипуляционные навыки и сохранять устойчивость при смене режима взаимодействия не рассматривается и не оценивается количественно.

Анализ современных работ по co-design показывает, что в большинстве случаев оптимизация морфологии и управления проводится относительно заранее заданных манипуляционных сценариев. Конструкция подбирается таким образом, чтобы демонстрировать высокое качество в конкретных условиях, однако при другом сценарии качество взаимодействия часто ухудшается.

Сценарий в данном проекте понимается как эксперимент с фиксированными начальными условиями: целевой объект, начальная поза, трение и возмущения, а также критерий успеха. 
Навык описывает устойчивый тип взаимодействия, который сохраняет свою структуру при изменении этих условий, он может реализовываться для различных объектов, при разных начальных позах и направлениях приложенной силы. То есть навык это множество сценариев.
А пространство навыков это набор навыков, которые морфология может выполнять успешно на диапазоне условий.

## Гипотеза

Если оптимизировать морфологию не под отдельные сценарии/задачи, а под пространство навыков (то есть под устойчивость нескольких разных режимов взаимодействия при изменении условий), то полученная конструкция будет:

сохранять качество захвата при смене объектов и начальных конфигураций, устойчивее переживать смену контактного режима (например, pinch → power), и требовать меньшей переоптимизации при изменении сценариев взаимодействия.

То есть “универсальность” будет появляться не только за счёт усложнения управления, а как измеримое свойство морфологии.

Baseline

В качестве базовой работы мы используем:
Co-Design of Soft Gripper with Neural Physics
Project: https://yswhynot.github.io/codesign-soft/

GitHub: https://github.com/yswhynot/codesign-soft-gripper

Paper: https://arxiv.org/abs/2505.20404

Почему выбрана именно эта работа

Во-первых, это один из самых “инженерно понятных” и воспроизводимых co-design пайплайнов для мягкого захвата: морфология параметризована (распределение жёсткости), управление учитывается совместно (поза), а дорогая физика ускоряется нейронным суррогатом, что делает поиск реалистичным по времени.

Во-вторых, baseline даёт удобную основу для нашей постановки: даже если мы не запускаем весь тяжёлый цикл генерации данных и обучения с нуля, сама идея “морфология как параметрический вектор + быстрый прокси” позволяет быстро тестировать, что происходит, если целевую функцию заменить с “успех одного сценария” на “устойчивость набора навыков”.

Будущая работа

Дальнейшая работа проекта будет состоять в том, чтобы перейти от сценарной оценки к skill-oriented оценке.

Мы задаём ограниченный набор навыков (например, pinch/power/удержание при возмущениях/простейший push), и для каждого навыка систематически варьируем условия выполнения: объект, начальную позу, параметры контакта и внешние воздействия. Для каждой морфологии мы будем собирать количественные метрики устойчивости (срыв контакта, проскальзывание, удержание при возмущениях, стабильность контактов во времени) и по ним определять, какие навыки реально поддерживаются устойчиво.

Дальше морфологии сравниваются не по одному сценарию, а по тому, насколько “широк” набор устойчивых навыков: конструкция, оптимизированная по пространству навыков, должна демонстрировать меньшую чувствительность к смене условий по сравнению с конструкцией, заточенной под один сценарий.

Параллельно мы фиксируем, что на текущем этапе не планируем обучать полноценные RL-политики: цель работы — измеримость и воспроизводимость пространства навыков и его связь с параметрами морфологии (а не “выиграть бенчмарк любой ценой”).

MVP: quick_test_skillspace.py

Поскольку полный пайплайн baseline тяжёлый (генерация данных, обучение суррогата, оптимизация), в репозитории есть простой MVP-скрипт quick_test_skillspace.py, который проверяет ключевую идею на упрощённой постановке.

Скрипт использует нейронный прокси simulate_neural и задаёт морфологию как вектор параметров дизайна stiffness_blocks (жёсткости блоков). Далее он многократно сэмплирует “навык + параметры навыка” (например, pinch/power/push с разной силой и т.п.), прогоняет прокси и сводит результат к одному числу score. Так получается приближённая оценка “качества по смеси навыков” вместо оценки одного сценария.

В режиме codesign реализован самый простой co-design: random search по stiffness_blocks. Генерируются кандидаты морфологий, каждая оценивается на нескольких испытаниях по навыкам, и выбирается лучшая по среднему score. Это не финальный алгоритм co-design, но быстрый тест гипотезы: “если оптимизировать по навыкам, а не по одному сценарию, меняется ли оптимальный дизайн и растёт ли устойчивость в среднем”.
